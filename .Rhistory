Region != "MEL"& Consol_CBM  <  67*0.95  ~"NDC check",
TRUE ~ NA_character_
))
predict_result_sum_ndc<- predict_result_pr |> filter(allocation_result_node_pr =="NDC check")  |>
group_by(Supplier) |>
summarise(Consol_CBM_NDC =sum(CBM))|> ungroup()
predict_result_node1<-left_join(predict_result_pr, predict_result_sum_ndc,  by = c("Supplier"))|>
mutate(
allocation_result_node1 = case_when(
allocation_result_node_pr == "NDC check" & CBM >= 67*0.95  ~ "NDC: FCL for single sku",
allocation_result_node_pr == "NDC check" & CBM<  67*0.95 &leftover_space> 0 &  leftover_space<=5~ "NDC: FCL for single sku by adjusting the volume quantity",
allocation_result_node_pr == "NDC check" & CBM<  67*0.95   & Consol_CBM_NDC >= 67*0.95 & leftover_space>5  ~ "NDC: FCL for consolidated sku",
allocation_result_node_pr == "NDC check" &  Consol_CBM_NDC < 67*0.95  ~ "Other strategy to wait for FCL consolidation",
TRUE~allocation_result_node_pr
))
predict_result_study<- predict_result_node1 |>
left_join(storage_cost, by ="Region") |>
left_join(dtrans_cost, by = c("State" = "Destination"))|>
rename(rdc_sf=Cost)|> mutate(CBM.cost =as.numeric(str_remove(CBM.cost, "\\$")),
ndc_storage = as.numeric(str_remove(ndc_storage, "\\$")),
rdc_storage=as.numeric(str_remove(rdc_storage, "\\$")))
ndc_sf<-predict_result_study |> group_by(Supplier,`Item Code`) |>filter(Region =="MEL")|>select(rdc_sf,Supplier)|> distinct()|> rename(ndc_sf=rdc_sf)
predict_result_final<-left_join(predict_result_study,ndc_sf, by =c("Supplier", "Item Code")) |>mutate(
Reg_cost =  67 *( rdc_storage) +  CBM *rdc_sf ,
NDC_cost = Consol_CBM* (ndc_sf+ rdc_storage + CBM.cost),
cost_difference =  if_else(Region == "MEL" |allocation_result_node1 %in% c("RDC: FCL for single sku", "RDC: FCL for consolidated sku","Other strategy to wait for FCL consolidation"),
NA, (NDC_cost-Reg_cost*0.95)),
allocation_result_node_final = if_else( !is.na(cost_difference)& cost_difference >= 0,"RDC: revise for cost analysis", allocation_result_node1),
cost_difference =if_else( is.na(cost_difference),"Not appliable", paste0("$",round(cost_difference,digits =2))
))
predict_result_final |>
select(`Item Code`, Region, Yearmonth, allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(Yearmonth =as.character(Yearmonth),
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(6:8,2)
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(Yearmonth =as.character(Yearmonth),
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(6:8,2)
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(6:8,2)
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}")))
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(6:7,2)
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(6:7,2)
predict_result_final
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(6:7,2)
predict_result_final |>
select(`Item Code`, Region,  allocation_result_node_final,
cost_difference, CBM, Consol_CBM, Consol_CBM_NDC)  |>
rename(`Final decision` = allocation_result_node_final,
`RDC consol` =Consol_CBM,
`NDC consol` =Consol_CBM_NDC)|>
mutate(
Region =factor(Region),
`Final decision` =factor(`Final decision`) ) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}"))) |> formatRound(5:7,2)
predict_result_final$allocation_result_node_final|> table()
predict_result_final$allocation_result_node_final|> table()
example_tsb_model_tbmt  |>
mutate( Yearmonth =as.character(Yearmonth),
Region = factor(Region),
Model =factor(model)) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}")))|> formatRound(6:13,0)
example_tsb_model_tbmt  |>
mutate( Yearmonth =as.character(Yearmonth),
Region = factor(Region),
Model =factor(Model)) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}")))|> formatRound(6:13,0)
example_mt_rbind |> mutate( Yearmonth =as.character(Yearmonth)) |>
select(-`Item & Region`) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}")))|> formatRound(5:11,0)
example_mt_rbind |> mutate( Yearmonth =as.character(Yearmonth),
Region =factor(Region),
`Item Code`  =factor(  `Item Code`)) |>
select(-`Item & Region`) |>
datatable( filter ="top",
callback=JS('
$("button.buttons-copy").css({
"background": "#81D8D0",
"border": "2px solid #000000",
"color":"white",
"fontweight":"bold",
"border-radius": "10px"
});
$("button.buttons-csv").css({
"background": "#FF7900",
"border": "2px solid #000000",
"border-radius": "10px",
"color":"white",
"fontweight":"bold"
});
return table;
')
,
extensions = c('Buttons', 'Scroller','FixedColumns'),
options = list(
scrollY = 400,
scroller = TRUE,
dom = 'Bfrtip',
scrollX = TRUE,
fixedColumns = TRUE,
buttons = list( list(extend = "copy", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="14" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"/></svg>'),
list(extend = "csv", text = '<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>')) ,
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#3A5311', 'color': '#fff'});",
"}")))|> formatRound(5:11,0)
View(ames_production_long)
View(example)
predict_result_final  |> group_by(Region, allocation_result_node_final) |> count()
predict_result_final  |> group_by(Region, allocation_result_node_final) |> count()|> pivot_wider(names_from = Region, values=n)
predict_result_final  |> group_by(Region, allocation_result_node_final) |> count()|> pivot_wider(names_from = Region, values_from=n)
result_tbl<-predict_result_final  |> group_by(Region, allocation_result_node_final) |> count()|> pivot_wider(names_from = Region, values_from=n)
result_tbl$Summary<-c(24,26,15,41,4)
result_tbl$`percent(%)`<-c("21.81%","23.64%","13.64%","37.27%","3.73%")
result_tbl|> datatable()
